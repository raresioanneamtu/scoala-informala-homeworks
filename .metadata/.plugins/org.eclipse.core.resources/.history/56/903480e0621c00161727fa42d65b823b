
/**
 * This class is a child class of BankAccount and it is used to save money with a commission fee for every withdrawal (i.e 0.2%) and
 * it generates interest (i.e 6% / year).
 * 
 * @ Rares Neamtu
 */
package siit.java.homeworks.bankaccounts;

import java.util.Calendar;
import java.util.Date;

public class SavingsAccount extends BankAccount{
	
	private float withdrawCommision;
	private float interest;

	public SavingsAccount(Date accountCreationDate, float monthlyFee, float withdrawalCommision, float interest, float withdrawCommision) {
		super(accountCreationDate, monthlyFee);
		this.withdrawCommision = withdrawCommision;
		this.interest = interest;
	}
	
	@Override
	public void withdrawFunds(float amount) throws InsufficientFundsException {
		super.withdrawFunds(amount + amount * withdrawCommision);
	}
	
	public float getBalance(Date balanceDate) {
		
		float balance = super.getBalance(balanceDate);
		return balance + getBalanceWithYearInterestApplied(balanceDate);
	
    }

	private float getBalanceWithYearInterestApplied(Date balanceDate) {
	
		Calendar accountCreationTime = Calendar.getInstance();
		accountCreationTime.setTime(accountCreationDate);
		// JANUARY is 0
		int accountCreationYear = accountCreationTime.get(Calendar.YEAR);
		Calendar balanceTime = Calendar.getInstance();
		balanceTime.setTime(balanceDate);
		int currentYear = balanceTime.get(Calendar.YEAR);
		return balance * interest * (currentYear - accountCreationYear);
	}

}
